version: '3.1'

services:
  user-service:
    environment:
      - JAVA_OPTS=-Xmx128m
      - ARGS=--spring.datasource.url=jdbc:postgresql://postgres-db:5432/user_db
    ports:
      - 22022:22022

  connector-hub-service:
    environment:
      - JAVA_OPTS=-Xmx128m
      - ARGS=--spring.datasource.url=jdbc:postgresql://postgres-db:5432/connector_hub_db
    ports:
      - 22023:22023

  invoker-service:
    environment:
    - JAVA_OPTS=-Xmx128m
    ports:
    - 22024:22024

  postgres-db:
    environment:
      - POSTGRES_USER=postgres
      - POSTGRES_PASSWORD=
    ports:
      - 5432:5432

  swagger-ui:
    image: swaggerapi/swagger-ui
    environment:
      - "API_URLS=[{url: \"http://${HOST_NAME:-localhost}/user-service/swagger/\", name: \"User\"}, {url: \"http://${HOST_NAME:-localhost}/connector-hub-service/swagger/\", name: \"Connector Hub\"}, {url: \"http://${HOST_NAME:-localhost}/invoker-service/swagger/\", name: \"Invoker\"}]"
      - BASE_URL=/swagger
    ports:
      - 8080:8080

  gateway:
    environment:
      - "HOST_NAME=${HOST_NAME:-localhost}"
    ports:
      - 80:80
